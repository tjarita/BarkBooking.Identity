2018-03-05 00:47:17.018 -08:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-03-05 00:47:17.064 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 00:47:17.068 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 00:47:17.069 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 00:47:17.070 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 00:47:17.071 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 00:47:36.853 -08:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-03-05 00:47:36.893 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 00:47:36.897 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 00:47:36.898 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 00:47:36.899 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 00:47:36.900 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 00:48:43.560 -08:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-03-05 00:48:43.611 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 00:48:43.614 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 00:48:43.614 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 00:48:43.615 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 00:48:43.615 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 00:48:55.534 -08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-03-05 00:50:01.328 -08:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-03-05 00:50:01.375 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 00:50:01.378 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 00:50:01.379 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 00:50:01.379 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 00:50:01.380 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 00:50:09.155 -08:00 [INF] You are using the in-memory version of the persisted grant store. This will store consent decisions, authorization codes, refresh and reference tokens in memory only. If you are using any of those features in production, you want to switch to a different store implementation.
2018-03-05 00:50:09.200 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 00:50:09.204 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 00:50:09.204 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 00:50:09.205 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 00:50:09.205 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 00:52:00.345 -08:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2018-03-05 00:52:00.424 -08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2018-03-05 00:52:00.431 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2018-03-05 00:52:00.436 -08:00 [DBG] Start discovery request
2018-03-05 00:52:00.706 -08:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2018-03-05 00:52:00.709 -08:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2018-03-05 00:52:00.710 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2018-03-05 00:52:00.713 -08:00 [DBG] Start key discovery request
2018-03-05 00:52:01.006 -08:00 [DBG] Request path /connect/token matched to endpoint type Token
2018-03-05 00:52:01.012 -08:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2018-03-05 00:52:01.013 -08:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2018-03-05 00:52:01.022 -08:00 [DBG] Start token request.
2018-03-05 00:52:01.027 -08:00 [DBG] Start client validation
2018-03-05 00:52:01.032 -08:00 [DBG] Start parsing Basic Authentication secret
2018-03-05 00:52:01.033 -08:00 [DBG] Parser found secret: BasicAuthenticationSecretParser
2018-03-05 00:52:01.035 -08:00 [DBG] Secret id found: client
2018-03-05 00:52:01.046 -08:00 [DBG] No matching hashed secret found.
2018-03-05 00:52:01.046 -08:00 [DBG] Secret validators could not validate secret
2018-03-05 00:52:01.099 -08:00 [INF] {
  "Name": "Client Authentication Failure",
  "Category": "Authentication",
  "EventType": "Failure",
  "Id": 1011,
  "ClientId": "client",
  "Message": "Invalid client secret",
  "ActivityId": "0HLC2EOCT7RMR:00000001",
  "TimeStamp": "2018-03-05T08:52:01Z",
  "ProcessId": 892,
  "LocalIpAddress": "::1:5000",
  "RemoteIpAddress": "::1"
}
2018-03-05 00:52:01.100 -08:00 [ERR] Client secret validation failed for client: client.
2018-03-05 01:02:52.644 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 01:02:52.674 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 01:02:52.675 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 01:02:52.676 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 01:02:52.676 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 01:03:07.431 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 01:03:07.460 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 01:03:07.461 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 01:03:07.461 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 01:03:07.462 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 01:05:41.420 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 01:05:41.453 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 01:05:41.453 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 01:05:41.453 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 01:05:41.454 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 01:05:41.610 -08:00 [DBG] Starting token cleanup
2018-03-05 01:05:51.311 -08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-03-05 01:06:11.957 -08:00 [ERR] Failed executing DbCommand (29ms) [Parameters=[@__p_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [x].[Key], [x].[ClientId], [x].[CreationTime], [x].[Data], [x].[Expiration], [x].[SubjectId], [x].[Type]
FROM [PersistedGrants] AS [x]
WHERE [x].[Expiration] < GETUTCDATE()
ORDER BY [x].[Key]
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'PersistedGrants'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:44d00da8-b94d-4cb8-b6f8-3cf1bf68c4c5
Error Number:208,State:1,Class:16
2018-03-05 01:06:12.029 -08:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.PersistedGrantDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'PersistedGrants'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.<_TrackEntities>d__17`2.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:44d00da8-b94d-4cb8-b6f8-3cf1bf68c4c5
Error Number:208,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'PersistedGrants'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.<_TrackEntities>d__17`2.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.Internal.LinqOperatorProvider.ExceptionInterceptor`1.EnumeratorExceptionInterceptor.MoveNext()
ClientConnectionId:44d00da8-b94d-4cb8-b6f8-3cf1bf68c4c5
Error Number:208,State:1,Class:16
2018-03-05 01:06:12.097 -08:00 [ERR] Exception clearing tokens: Object reference not set to an instance of an object.
2018-03-05 01:16:01.963 -08:00 [DBG] Using Identity.Application as default scheme for authentication
2018-03-05 01:16:01.997 -08:00 [DBG] Using Identity.External as default scheme for sign-in
2018-03-05 01:16:01.997 -08:00 [DBG] Using Identity.External as default scheme for sign-out
2018-03-05 01:16:01.997 -08:00 [DBG] Using Identity.Application as default scheme for challenge
2018-03-05 01:16:01.998 -08:00 [DBG] Using Identity.Application as default scheme for forbid
2018-03-05 01:16:02.085 -08:00 [DBG] Starting token cleanup
2018-03-05 01:16:17.146 -08:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2018-03-05 01:16:32.111 -08:00 [INF] Clearing 0 tokens
